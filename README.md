# Платформа для онлайн-консультаций с врачами

**Версия: 1.0.0**

## Описание проекта

Платформа для онлайн-консультаций с врачами - это программный комплекс, предназначенный для связи пациентов с медицинскими специалистами. Система позволяет пользователям (пациентам) находить врачей по специализации и району, просматривать их профили, оплачивать консультацию и общаться с выбранным врачом в защищенном чате. Врачи могут использовать платформу как дополнительный канал для проведения консультаций и заработка.

Текущая версия проекта сосредоточена на базовом функционале веб-приложения и бэкенда, включая регистрацию с подтверждением email, аутентификацию по JWT, управление профилями Пациентов и Врачей.

## Технологический стек

Проект разработан с использованием следующих технологий:

*   **Бэкенд:** Python (FastAPI), SQLAlchemy (ORM), PyMySQL (драйвер БД), Alembic (миграции БД), Passlib (хеширование паролей), python-jose (JWT), python-dotenv (переменные окружения).
*   **Фронтенд (Web):** React, Vite, SASS, React Router (роутинг), Axios (HTTP-клиент), Zustand (управление состоянием).
*   **База данных:** MySQL/MariaDB.
*   **Контейнеризация (для локальной разработки и развертывания):** Docker, Docker Compose.

## Установка и запуск (с использованием Docker Compose)

**Рекомендуемый способ запуска проекта - использование Docker Compose**, так как он обеспечивает консистентное окружение для базы данных и бэкенда.

1.  **Клонируйте репозиторий:**
    ```bash
    git clone <URL_вашего_репозитория>
    cd med-consult-platform # Перейдите в корневую директорию проекта
    ```
    (Замените `<URL_вашего_репозитория>` на реальный URL вашего репозитория на GitHub).

2.  **Настройте переменные окружения:**
    *   В корневой директории проекта находится файл `.env` (он игнорируется Git из соображений безопасности). Если его нет, создайте его: `touch .env`.
    *   Откройте файл `.env` и добавьте следующие переменные. **Обязательно замените значения на свои надежные данные!**
        ```env
        # Переменные окружения для Docker Compose и бэкенда
        # Используются в docker-compose.yml и в коде бэкенда (.env в backend/ игнорируется!)

        # Настройки базы данных MySQL/MariaDB
        MYSQL_ROOT_PASSWORD=ВАШ_ОЧЕНЬ_НАДЕЖНЫЙ_РУТ_ПАРОЛЬ
        MYSQL_DATABASE=online_doctors_db
        MYSQL_USER=vrachi_user
        MYSQL_PASSWORD=ВАШ_НАДЕЖНЫЙ_ПАРОЛЬ_БЕЗ_СОБАК_И_ДОЛЛАРОВ # Используйте простой пароль без спец. символов для начала, если возникнут проблемы

        # Секретный ключ для JWT токенов (генерируется бэкендом)
        # Генерируется на стороне бэкенда, но секретный ключ для подписи хранится здесь.
        SECRET_KEY="ВАШ_СУПЕР_СЕКРЕТНЫЙ_КЛЮЧ_ДЛЯ_JWT" # Используйте длинную случайную строку!

        # Базовый URL для подтверждения email на фронтенде
        # Этот URL будет отправлен пользователю в "письме" (пока выводится в консоль бэкенда)
        # В разработке обычно http://localhost:порт_фронтенда/verify-email
        VERIFICATION_BASE_URL="http://localhost:5173/verify-email" # Убедитесь, что порт соответствует порту запуска фронтенда
        ```
    *   Сохраните и закройте файл `.env`.

3.  **Запустите контейнеры с использованием Docker Compose:**
    Убедитесь, что Docker установлен и запущен в вашей системе.
    ```bash
    sudo docker-compose up -d --build
    ```
    Эта команда соберет образ бэкенда (на основе `Dockerfile` в папке `backend/`), запустит контейнеры для базы данных и бэкенда в фоновом режиме (`-d`) и перестроит образ бэкенда, если были изменения (`--build`). При первом запуске она также создаст базу данных и пользователя.

4.  **Выполните миграции базы данных (первый раз или после изменений моделей):**
    Миграции Alembic создают и обновляют структуру таблиц в базе данных.
    ```bash
    sudo docker-compose exec backend_app alembic upgrade head
    ```
    Эта команда выполнит миграцию внутри контейнера бэкенда. Если это первый запуск, будут созданы все таблицы (`users`, `patient_profiles`, `doctor_profiles`, `alembic_version`).

5.  **Запустите фронтенд (React приложение):**
    Откройте **новый терминал** и перейдите в директорию фронтенда:
    ```bash
    cd frontend/
    ```
    Установите зависимости (если еще не сделали):
    ```bash
    npm install
    ```
    Запустите сервер разработки фронтенда:
    ```bash
    npm run dev
    ```

6.  **Откройте приложение в браузере:**
    Фронтенд будет доступен по адресу, который покажет Vite в консоли (обычно `http://localhost:5173/`).
    Бэкенд будет доступен по адресу `http://127.0.0.1:8000`.

## Использование API и тестирование

После запуска фронтенда и бэкенда:

1.  **Регистрация:** Перейдите на страницу `/register` во фронтенде. Заполните форму и зарегистрируйте нового пользователя. **В консоли бэкенда (где запущен `uvicorn`) вы увидите ссылку для подтверждения email.**
2.  **Подтверждение Email:** Скопируйте ссылку из консоли бэкенда и откройте ее в браузере. Фронтенд на странице `/verify-email` отправит запрос на бэкенд для активации пользователя.
3.  **Вход:** Перейдите на страницу `/login`. Используйте email и пароль пользователя, email которого вы только что подтвердили. После успешного входа вы будете перенаправлены на главную страницу.
4.  **Просмотр и редактирование профиля:** После входа перейдите на страницу `/profile` (ссылка появится в навигации). Вы сможете просмотреть свой профиль и, если он еще не создан, заполнить его (для Пациента или Врача, в зависимости от роли).

Вы также можете взаимодействовать с API бэкенда напрямую через интерактивную документацию Swagger UI, доступную по адресу `http://127.0.0.1:8000/docs`. Для тестирования защищенных эндпоинтов необходимо получить JWT токен через `/token` и использовать кнопку "Authorize" в Swagger UI (тип "Bearer", вставить только токен).

## Локальная разработка без Docker Compose

Если у вас возникли проблемы с Docker Compose, вы можете установить и запустить базу данных и бэкенд локально:

1.  **Установите MySQL/MariaDB сервер** в вашей системе и создайте базу данных `online_doctors_db` и пользователя `vrachi_user` с паролем и правами на эту базу. (См. инструкции по установке и настройке MariaDB для вашего дистрибутива Linux).
2.  **Установите зависимости Python** для бэкенда в виртуальное окружение (`cd backend/ && python -m venv venv && source venv/bin/activate && pip install -r requirements.txt`). Убедитесь, что файл `backend/requirements.txt` содержит все необходимые пакеты.
3.  **Измените строку подключения к базе данных** в файлах `backend/alembic.ini` и `backend/models.py` на `mysql+pymysql://vrachi_user:ВАШ_ПАРОЛЬ@localhost:3306/online_doctors_db`.
4.  **Выполните миграции Alembic локально** (`cd backend/ && source venv/bin/activate && alembic upgrade head`).
5.  **Запустите бэкенд локально** (`cd backend/ && source venv/bin/activate && uvicorn main:app --reload`).
6.  **Запустите фронтенд локально** (`cd frontend/ && npm install && npm run dev`).

## Вклад в разработку

(Раздел для описания процесса внесения изменений, создания веток, пулл-реквестов, если проект открытый)

## Лицензия

(Информация о лицензии проекта, например MIT)

---